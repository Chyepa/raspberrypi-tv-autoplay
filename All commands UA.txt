–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –æ–±—Ä–∞–∑ —Ö64 –∑ —Ä–æ–±–æ—á–∏–º —Å—Ç–æ–ª–æ–º (–ø–æ—Ç—ñ–º –π–æ–≥–æ –≤–∏–º–∫–Ω–µ–º–æ, —Ü—è –≤–µ—Ä—Å—ñ—è –º–∞—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞–∫–µ—Ç–∏ —ñ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—à–µ –ø—Ä–∞—Ü—é—î)

–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤
sudo apt install -y ntpdate
sudo apt install -y cec-utils curl net-tools overlayroot ntpdate

–í–∏–º–∏–∫–∞—î–º–æ —Ä–æ–±–æ—á–∏–π —Å—Ç—ñ–ª 
sudo raspi-config  
System>Boot>B1

–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–µ–∑–µ—Ä–≤–Ω–µ –≤—ñ–¥–µ–æ –∑ –≥—É–≥–ª –¥–∏—Å–∫—É, –Ω–∞ –≥—É–≥–ª –¥–∏—Å–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –≤—Å—ñ–º —Ö—Ç–æ –º–∞—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è
URL="https://drive.google.com/file/d/1jImUISz......./view?usp=sharing"; \
ID=$(echo "$URL" | sed -n 's#.*\/d\/\([^\/]*\).*#\1#p'); \
C=/tmp/gdcookie; \
curl -s -c "$C" "https://drive.google.com/uc?export=download&id=$ID" >/dev/null; \
CODE=$(awk '/download_warning/ {print $NF}' "$C"); \
curl -s -L -b "$C" "https://drive.google.com/uc?export=download&confirm=$CODE&id=$ID" -o fallback.mp4; \
ls -lh fallback.mp4

–ê–±–æ –ø—Ä—è–º–æ –∑ —Ö–æ—Å—Ç–∞ (—ñ–Ω–∫–æ–ª–∏ –∑–∞–º—ñ—á–∞–≤, —â–æ cloudflare –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—î —Ç–∞–∫–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Ç–æ —è –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞–≤ tor —ñ —Å–∫–∞—á—É–≤–∞–≤ —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ)
curl -L -o fallback.mp4 https://yourhost.com.ua/raspberry/coffe.mp4

–í–∏–º–∫–Ω–µ–Ω–Ω—è –µ–Ω–µ—Ä–≥–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ –≤–∞–π—Ñ–∞—é (–Ω–µ–∑–Ω–∞—é —á–∏ –ø—Ä–∞—Ü—é—î, –ª–æ–≥–∏ –Ω–µ –º—ñ–≥ –∑–Ω–∞–π—Ç–∏, —Ç–∞–∫ —è–∫ –ø–µ—Ä–µ–π—à–æ–≤ –Ω–∞ –∫–∞–±–µ–ª—å micro-usb>LAN
sudo nano /etc/rc.local
–Ü –ø–µ—Ä–µ–¥ exit 0 –¥–æ–¥–∞—î–º–æ:
iw dev wlan0 set power_save off

–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤ (–≤–º—ñ—Å—Ç –≤ —Ñ–∞–π–ª–∞—Ö –ø—Ä–æ–µ–∫—Ç—É)
sudo nano play_video.sh  

sudo nano tv_cron.sh

–ù–∞–¥–∞—î–º–æ –¥–æ—Å—Ç—É–ø –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤
sudo chmod +x /home/yaroslav/play_video.sh    sudo chmod +x /home/yaroslav/tv_cron.sh

–°—Ç–≤–æ—Ä–∏—Ç–∏ systemd —Å–µ—Ä–≤—ñ—Å tvcontrol.service (–≤–º—ñ—Å—Ç –≤ —Ñ–∞–π–ª–∞—Ö –ø—Ä–æ–µ–∫—Ç—É)
sudo nano /etc/systemd/system/tvcontrol.service

–ê–∫—Ç–∏–≤–æ–≤—É—î–º–æ —Å–µ—Ä–≤—ñ—Å
sudo systemctl daemon-reload
sudo systemctl enable tvcontrol.service

–©–æ–¥–µ–Ω–Ω–∏–π —Ä–µ–±—É—Ç, —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ tv_cron.sh
crontab -e
–≤ –∫—ñ–Ω—Ü—ñ –¥–æ–±–∞–≤–ª—è—î–º–æ —Ü–µ
*/5 * * * * /home/yaroslav/tv_cron.sh
0 4 * * * /sbin/reboot

–ü–µ—Ä–µ–∫–ª–∞–¥ —Å–∏—Å—Ç–µ–º–∏ –≤ read-only
–£–≤—ñ–º–∫–Ω—É—Ç–∏ overlayroot:

sudo nano /etc/overlayroot.conf

–≤ –∫—ñ–Ω—Ü—ñ –∑–º—ñ–Ω—é—î–º–æ overlayroot="" –Ω–∞ overlayroot="tmpfs"
–∑–±–µ—Ä—ñ–≥–∞—î–º–æ —Ç–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –∑–º—ñ–Ω–∏
sudo update-initramfs -u

–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ rad-only:
mount | grep 'on / '
–ú–∞—î –±—É—Ç–∏:
overlay on / type overlay (ro,...)

–õ–û–ì–ò
cat /dev/shm/tv.log


‚úÖ –Ø–∫ —Ç–∏–º—á–∞—Å–æ–≤–æ –≤–∏–º–∫–Ω—É—Ç–∏ overlayroot (–Ω–∞ 1 —Å–µ—Å—ñ—é):

 –£–≤—ñ–π–¥–∏ –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è root-—Ñ–∞–π–ª—ñ–≤ (chroot)

sudo overlayroot-chroot

3Ô∏è‚É£ –†–µ–¥–∞–≥—É–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
nano /etc/overlayroot.conf
üîß –ó–∞–º—ñ–Ω–∏:
overlayroot=tmpfs
–ù–∞:
overlayroot=disabled
–ó–±–µ—Ä–µ–∂–∏: Ctrl + O, –ø–æ—Ç—ñ–º Enter, —ñ –≤–∏–π–¥–∏: Ctrl + X

4Ô∏è‚É£ –û–Ω–æ–≤–∏ initramfs
update-initramfs -u
sudo update-initramfs -u
–¶–µ –æ–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω–∏–π –æ–±—Ä–∞–∑ —Å—Ç–∞—Ä—Ç—É. –Ø–∫—â–æ –∑'—è–≤–ª—è—î—Ç—å—Å—è –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è:
W: Couldn't identify type of root file system for fsck hook
‚Äî —ñ–≥–Ω–æ—Ä—É–π –π–æ–≥–æ, —Ü–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

5Ô∏è‚É£ –í–∏–π–¥–∏ –∑ chroot

exit
6Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ —Å–∏—Å—Ç–µ–º—É

sudo reboot
7Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä, —â–æ overlayroot –≤–∏–º–∫–Ω–µ–Ω–æ
–ü—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–π:
mount | grep 'on / '
–ú–∞—î –∑‚Äô—è–≤–∏—Ç–∏—Å—è:
/dev/mmcblk0p2 on / type ext4 (rw,...

–ù–∞ —Ç–µ–ª–µ–≤—ñ–∑–æ—Ä—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∫–ª—é—á–∏—Ç–∏ CEC –ø—ñ–¥—Ç—Ä–∏–º–∫—É, —â–æ–± —Ç–µ–ª–µ–≤—ñ–∑–æ—Ä –≤–º–∏–∫–∞–≤—Å—è —Ç–∞ –≤–∏–º–∏–∫–∞–≤—Å—è.
–î–ª—è –ø—Ä–µ–≤—ñ—Ä–∫–∏
–≤–∫–ª—é—á–∏—Ç–∏ —Ç–µ–ª–µ–≤—ñ–∑–æ—Ä
echo "on 0" | cec-client -s -d 1
–≤–∏–∫–ª—é—á–∏—Ç–∏
echo "standby 0" | cec-client -s -d 1

–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ —á–∏ –≤—ñ–¥–µ–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–æ—Å—å
ls -lh fallback.mp4 



